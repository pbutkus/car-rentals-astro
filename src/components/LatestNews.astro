---
import { CollectionEntry, getCollection } from "astro:content";
const blogPosts = await getCollection("blog");

interface BlogCard {
  title: string;
  publishingDate: string;
  image: string;
  summary: string;
  slug: string;
}

const cards: BlogCard[] = [];

blogPosts.length = 3;

blogPosts.map((post) => {
  const title = post.data.title;
  const publishingDate = post.data.publishingDate.toLocaleDateString();
  const image = post.data.featuredImage;
  const summary = post.data.intro.substring(0, 196).trim() + "...";
  const slug = post.slug;

  cards.push({ title, publishingDate, image, summary, slug });
});
---

<div class="flex flex-col my-24">
  <div>
    <h2 class="font-semibold text-3xl text-center">Latest News</h2>
  </div>
  <div class="flex flex-row justify-between mx-12 mt-12">
    {
      cards.map((card) => (
        <a href={`/blog/${card.slug}`}>
          <div class="flex flex-col shadow-md w-96 h-full hover:translate-y-2 transition-transform">
            <img class="object-cover h-64" src={card.image} alt={card.title} />
            <div class="flex h-1/3 items-center">
              <h3 class="px-4 py-2 font-semibold">{card.title}</h3>
            </div>
            <div>
              <div class="px-4 pb-2 font-light">
                <p>{card.summary}</p>
              </div>
              <div class="flex flex-row justify-between px-4 py-2">
                <div class="w-1/2">
                  <a href={`/blog/${card.slug}`}>Read full article</a>
                </div>
                <div class="w-1/2 text-right">
                  <p>{card.publishingDate}</p>
                </div>
              </div>
            </div>
          </div>
        </a>
      ))
    }
  </div>
</div>
